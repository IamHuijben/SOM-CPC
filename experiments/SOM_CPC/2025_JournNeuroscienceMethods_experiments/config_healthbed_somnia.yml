callbacks:
  PlotLoss:
    every_n_epochs: 10
    zero_class_is_nan_class: true
  SOMmap:
    checking_metric: null
    every_n_epochs: 10
    nr_nodes: 100
    zero_class_is_nan_class: true
  SaveModel:
    checking_metric: loss
    every_n_epochs: 10
data:
  align_with_labels: true
  class: Healthbed_SomniaContrastive
  crop_size: 5
  crop_size_cs: 5
  include_even_channels:
  - c4_m1
  include_odd_channels: []
  include_train_subjects: all
  include_val_subjects: all
  neg_samples: 3
  neg_sampling: within_patient
  past_windows: 0
  pos_samples: 3
device:
  cuda: true
  gpu_idx: null
losses:
  SOM_loss:
    arguments:
      detach_from_encoder: false
      reduction: sum
      similarity_metric: mse
    class: SOM_loss
    multiplier: 0.001
  commitment_loss:
    arguments:
      detach_from_encoder: false
      reduction: sum
      similarity_metric: mse
    class: commitment_loss
    multiplier: 0.001
  infoNCE:
    arguments:
      neg_samples: 3
      norm_cos_sim: false
      pos_samples: 3
      reduction: sum
      temperature: 1
      weighing_prediction_losses: null
    class: InfoNCELoss
    multiplier: 1.0
model:
  ARmodel:
    class: null
  checkpoint_path: null
  classifier:
    activation: null
    bias: false
    checkpoint_path: null
    class: Classifier
    freeze: false
    input_channels: 128
    out_activation: null
    output_channels:
    - 128
  encoder:
    activation:
      type: leakyrelu
    bias: true
    channels:
    - 16
    - 32
    - 64
    - 128
    checkpoint_path: null
    class: ConvEncoder1D
    dilations: 1
    dropouts:
      '0': 0.1
      '1': 0.1
      '2': 0.1
    encode_windows_separately: true
    freeze: false
    input_dim:
    - 1
    - 640
    kernel_sizes:
      '0': 15
      '1': 9
      '2': 5
      '3': 3
    last_linear_layer: null
    out_activation: null
    paddings:
      '0': 0
      '1': 0
      '2': 0
      '3': 0
    poolings:
      '0':
        kernel_size: 5
        type: Max
      '1':
        kernel_size: 5
        type: Max
      '2':
        kernel_size: 5
        type: Max
      '3':
        output_size: 1
        type: AdaptiveAvg
    stacked_convs: 1
    strides: 1
  quantizer:
    class: SOMQuantizer
    freeze: false
    gaussian_neighbourhood:
      n_epochs: 500
      omit_center_weight: true
      sigma_end: 0.5
    ontopof_ARmodule: false
    som_nodes: 100
    transitions: false
    z_dim: 128
  type: SOM_CPC
optimizer:
  lr: 0.0001
  lr_scheduler:
    arguments:
      min_lr: 1.0e-06
      patience: 50
      verbose: true
    initial_patience: 200
    type: ReduceLROnPlateau
  type: Adam
training:
  aggregate_pred_names:
  - all_codebook_idxs
  - all_z_cont
  data_shuffle: true
  n_epochs: 500
  random_seed: 1
  train_batch_size: 256
  val_batch_size: 256
